---
layout: post
title: Blog Post 2: Spectral Clustering
---

Blog Post 2: Spectral Clustering

> In this blog post, I'll write a tutorial on a simple version of the *spectral clustering* algorithm for clustering data points. Each of the below parts are necessary specific tasks for creating the spectral clustering.

### Notation

Before starting doing some linear algebra in python, here are some specified notations used in this blog post:

- Boldface capital letters like **A** refer to matrices (2d arrays of numbers). 
- Boldface lowercase letters like **v** refer to vectors (1d arrays of numbers). 
- **AB** refers to a matrix-matrix product (`A@B`). **Av** refers to a matrix-vector product (`A@v`).

## Introduction

This part is the introduction of studying *spectral clustering*. Spectral clustering is an important tool for identifying meaningful parts of data sets with complex structure. To start, let's look at an example where we *don't* need spectral clustering.

```python
import numpy as np
from sklearn import datasets
from matplotlib import pyplot as plt
```
```python
n = 200
np.random.seed(1111)
X, y = datasets.make_blobs(n_samples=n, shuffle=True, random_state=None, centers = 2, cluster_std = 2.0)
plt.scatter(X[:,0], X[:,1])
```
BP2_intro_1.png

*Clustering* refers to the task of separating this data set into the two natural "blobs." K-means is a very common way to achieve this task, which has good performance on circular-ish blobs like these:

```python
from sklearn.cluster import KMeans
km = KMeans(n_clusters = 2)
km.fit(X)

plt.scatter(X[:,0], X[:,1], c = km.predict(X))
```
BP2_intro_2.png


## Harder Clustering

That was all well and good, but what if our data is "shaped weird"? Here, we can use the function `make_moons` supported by python to make the moonlike clusters:

```python
np.random.seed(1234)
n = 200
X, y = datasets.make_moons(n_samples=n, shuffle=True, noise=0.05, random_state=None)
plt.scatter(X[:,0], X[:,1])
```
BP2_harder_clustering_1.png

Similar as in *Intro*, can still make out two meaningful clusters in the data, but now they aren't blobs but crescents. As before, the Euclidean coordinates of the data points are contained in the matrix `X`, while the labels of each point are contained in `y`. Now k-means won't work so well, because k-means is, by design, looking for circular clusters. 

```python
km = KMeans(n_clusters = 2)
km.fit(X)
plt.scatter(X[:,0], X[:,1], c = km.predict(X))
```
BP2_harder_clustering_2.png

Clearly from the figure above, the clustering went wrong with the k-Means algorithm.

As will suggest below, spectral clustering is able to correctly cluster the two crescents. The following parts shows how to derive and implement spectral clustering.


{::options parse_block_html="true" /}
<div class="got-help">
I learned something really cool from my peer feedback! 
</div>
{::options parse_block_html="false" /}

{::options parse_block_html="true" /}
<div class="gave-help">
I gave one of my peers a cool suggestion! 
</div>
{::options parse_block_html="false" /}