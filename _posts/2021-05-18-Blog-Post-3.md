---
layout: post
title: Blog Post 3 - Fake News Classification
---

> In this blog post, I'll create a machine learning model for classifying fake news using `Tensorflow` supported by python

## Preparation: Import Packages

Before all, want to first import necessary python packages for the model creation

```python



from sklearn.decomposition import PCA
import plotly.express as px

from plotly.io import write_html
```


# Part I: Acquire Training Data

# Part II: Data Preparation

## 2.1 Prepare and Create Tensorflow Dataset

## 2.2 Train-Validation Separation

# Part III: Model Creation and Comparison

## 3.1 Model 1: Title-Only Analysis

## 3.2 Model 2: Text-Only Analysis

## 3.3 Model 3: Title-Text Analysis

# Part IV: Model Evaluation

# Part V: Embeddings

```python
title_weights = combined_model.get_layer('titles').get_weights()[0] # get the weights from the titles layer
text_weights = combined_model.get_layer('texts').get_weights()[0] # get the weights from the texts layer
vocab = vectorize_layer.get_vocabulary()
```

```python
def embedding_plot(weights):

  pca = PCA(n_components=2)
  weights = pca.fit_transform(weights)

  embedding_df = pd.DataFrame({
      'word' : vocab, 
      'x0'   : weights[:,0],
      'x1'   : weights[:,1]
  })

  fig = px.scatter(embedding_df, 
                 x = "x0", 
                 y = "x1", 
                 size = list(np.ones(len(embedding_df))),
                 size_max = 2,
                 hover_name = "word")
  return fig
```

```python
title_fig = embedding_plot(title_weights)
text_fig = embedding_plot(text_weights)
```

```python
write_html(title_fig, "title_fig.html")
```
{% include BP3_title_fig.html %}

```python
write_html(text_fig, "text_fig.html")
```
{% include BP3_text_fig.html %}
